<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>GMM Estimation - Higher Order Models &#8212; spreg v1.8.6.dev8+g715b6dea5 Manual</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=9afac83c" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pysal-styles.css?v=b100b7f1" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="../_static/documentation_options.js?v=c2ae4888"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/pysal_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Spatial Panel Models with Fixed Effects" href="Panel_FE_example.html" />
    <link rel="prev" title="GMM Estimation - Spatial Error Model" href="16_GMM_estimation_spatial_error.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          spreg</a>
        <span class="navbar-text navbar-version pull-left"><b>1.8.6.dev8+g715b6dea5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../installation.html">Installation</a></li>
                <li><a href="../tutorials.html">Tutorials</a></li>
                <li><a href="../api.html">API</a></li>
                <li><a href="../references.html">References</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_sample_data.html">PySAL Sample Data Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_data_input_output.html">Data Input/Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_basic_mapping.html">Basic Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_spatial_weights.html">Spatial Weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_OLS.html">Basic Ordinary Least Squares Regression (OLS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_TWOSLS.html">Two Stage Least Squares Regression (2SLS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_spatial_models.html">Spatial Model Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="8_spatial_multipliers.html">Spatial Multipliers</a></li>
<li class="toctree-l2"><a class="reference internal" href="9_specification_tests.html">Specification Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="10_specification_tests_properties.html">Specification Tests - Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="11_distance_decay.html">Distance Decay</a></li>
<li class="toctree-l2"><a class="reference internal" href="12_estimating_slx.html">Estimating SLX Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="13_ML_estimation_spatial_lag.html">Maximum Likelihood Estimation - Spatial Lag Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="14_IV_estimation_spatial_lag.html">Instrumental Variables Estimation - Spatial Lag Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="15_ML_estimation_spatial_error.html">Maximum Likelihood Estimation - Spatial Error Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_GMM_estimation_spatial_error.html">GMM Estimation - Spatial Error Model</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">GMM Estimation - Higher Order Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="Panel_FE_example.html">Spatial Panel Models with Fixed Effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="skater_reg.html">Skater Regression</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api.html#classic-models">Classic Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#spatial-regression-models">Spatial Regression Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#discrete-choice-models">Discrete Choice Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#regimes-models">Regimes Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#seemingly-unrelated-regressions">Seemingly-Unrelated Regressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#spatial-panel-models">Spatial Panel Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#diagnostics">Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#spatial-specification-search">Spatial Specification Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#dgp">DGP</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">GMM Estimation - Higher Order Models</a><ul>
<li><a class="reference internal" href="#Luc-Anselin">Luc Anselin</a></li>
<li><a class="reference internal" href="#(revised-09/26/2024)">(revised 09/26/2024)</a><ul>
<li><a class="reference internal" href="#Preliminaries">Preliminaries</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Modules-Needed">Modules Needed</a></li>
<li><a class="reference internal" href="#Functions-Used">Functions Used</a></li>
<li><a class="reference internal" href="#Variable-definition-and-data-input">Variable definition and data input</a><ul>
<li><a class="reference internal" href="#The-SAR-SAR-Model">The SAR-SAR Model</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Exogenous-variables-only">Exogenous variables only</a></li>
<li><a class="reference internal" href="#Exogenous-and-endogenous-variables">Exogenous and endogenous variables</a><ul>
<li><a class="reference internal" href="#The-GNS-Model">The GNS Model</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id2">Exogenous variables only</a></li>
<li><a class="reference internal" href="#id3">Exogenous and endogenous variables</a><ul>
<li><a class="reference internal" href="#Practice">Practice</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="admonition note">
<p>This page was generated from <a class="reference external" href="https://github.com/pysal/spreg/blob/master/notebooks/17_GMM_higher_order.ipynb">notebooks/17_GMM_higher_order.ipynb</a>.
Interactive online version:
<span class="raw-html"><a href="https://mybinder.org/v2/gh/pysal/spreg/master?filepath=notebooks/17_GMM_higher_order.ipynb"><img alt="Binder badge" src="https://mybinder.org/badge_logo.svg" style="vertical-align:text-bottom"></a></span></p>
</div>
<section id="GMM-Estimation---Higher-Order-Models">
<h1>GMM Estimation - Higher Order Models<a class="headerlink" href="#GMM-Estimation---Higher-Order-Models" title="Link to this heading">¶</a></h1>
<section id="Luc-Anselin">
<h2>Luc Anselin<a class="headerlink" href="#Luc-Anselin" title="Link to this heading">¶</a></h2>
</section>
<section id="(revised-09/26/2024)">
<h2>(revised 09/26/2024)<a class="headerlink" href="#(revised-09/26/2024)" title="Link to this heading">¶</a></h2>
<section id="Preliminaries">
<h3>Preliminaries<a class="headerlink" href="#Preliminaries" title="Link to this heading">¶</a></h3>
<p>This module covers the estimation of higher order spatial models, such as SAR-SAR (spatial lag with spatial autoregressive errors) and the generalized nested specification (GNS), i.e., a Spatial Durbin model with spatial autoregressive errors. These specifications are estimated as special cases of <code class="docutils literal notranslate"><span class="pre">spreg.GMM_Error</span></code>, by including the argument <code class="docutils literal notranslate"><span class="pre">add_wy</span> <span class="pre">=</span> <span class="pre">True</span></code>, without or with <code class="docutils literal notranslate"><span class="pre">slx_lags</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
<p>In general, these specifications should be avoided, but they are included here for the sake of completeness. As shown by Koley and Bera (2024), the full set of parameters in the GNS model is not identified, and ML cannot be applied. The SAR-SAR models suffers from similar problems, and its ML estimation typically has a very hard time to convert, switching back and forth between the estimates for <span class="math notranslate nohighlight">\(\rho\)</span> and <span class="math notranslate nohighlight">\(\lambda\)</span> (this is referred to by Bivand and Piras in the <code class="docutils literal notranslate"><span class="pre">R-spatialreg</span></code>
package as the “banana” problem). As a result, ML estimation of these models is not included in <em>spreg</em>. However, it remains possible to estimate them by means of IV/GMM methods, although the results need to be interpreted with caution. Also, as it turns out, in practice, the results often do not make sense and are difficult to interpret.</p>
</section>
</section>
<section id="Modules-Needed">
<h2>Modules Needed<a class="headerlink" href="#Modules-Needed" title="Link to this heading">¶</a></h2>
<p>The same modules are needed as for the GMM estimation of the error model: <code class="docutils literal notranslate"><span class="pre">GMM_Error</span></code> imported from <code class="docutils literal notranslate"><span class="pre">spreg</span></code>, utilities in <em>libpysal</em> (to open spatial weights and access the sample data set), <em>pandas</em> and <em>geopandas</em>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import warnings
warnings.filterwarnings(&quot;ignore&quot;)
import os
os.environ[&#39;USE_PYGEOS&#39;] = &#39;0&#39;

import numpy as np
import pandas as pd
import geopandas as gpd
from libpysal.io import open
from libpysal.examples import get_path
from libpysal.weights import lag_spatial

from spreg import GMM_Error
</pre></div>
</div>
</div>
</section>
<section id="Functions-Used">
<h2>Functions Used<a class="headerlink" href="#Functions-Used" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>from pandas/geopandas:</p>
<ul>
<li><p>read_file</p></li>
</ul>
</li>
<li><p>from libpysal:</p>
<ul>
<li><p>io.open</p></li>
<li><p>examples.get_path</p></li>
</ul>
</li>
<li><p>from spreg:</p>
<ul>
<li><p>spreg.GMM_Error</p></li>
</ul>
</li>
</ul>
</section>
<section id="Variable-definition-and-data-input">
<h2>Variable definition and data input<a class="headerlink" href="#Variable-definition-and-data-input" title="Link to this heading">¶</a></h2>
<p>The data set and spatial weights are again from the <strong>chicagoSDOH</strong> sample data set. They are the same as for the GMM Error estimation:</p>
<ul class="simple">
<li><p><strong>Chi-SDOH.shp,shx,dbf,prj</strong>: socio-economic indicators of health for 2014 in 791 Chicago tracts</p></li>
<li><p><strong>Chi-SDOH_q.gal</strong>: queen contiguity weights</p></li>
</ul>
<p>To illustrate the methods, the same descriptive model is used as in the ML notebook. It relates the rate of uninsured households in a tract(for health insurance, <strong>EP_UNINSUR</strong>) to the lack of high school education (<strong>EP_NOHSDP</strong>), the economic deprivation index (<strong>HIS_ct</strong>), limited command of English (<strong>EP_LIMENG</strong>) and the lack of access to a vehicle (<strong>EP_NOVEH</strong>). This is purely illustrative of a spatial error specification and does not have a particular theoretical or policy motivation.</p>
<p>In an alternative specification, <strong>HIS_ct</strong> is considered to be endogenous, with, as before, <strong>COORD_X</strong> and <strong>COORD_Y</strong> as instruments.</p>
<p>The file names and variable names are set in the usual manner. Any customization for different data sets/weights and different variables should be specified in this top cell.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>infileshp = get_path(&quot;Chi-SDOH.shp&quot;)     # input shape file with data
infileq = get_path(&quot;Chi-SDOH_q.gal&quot;)     # queen contiguity weights created with GeoDa

y_name = &#39;EP_UNINSUR&#39;
x_names = [&#39;EP_NOHSDP&#39;,&#39;HIS_ct&#39;,&#39;EP_LIMENG&#39;,&#39;EP_NOVEH&#39;]
xe_names = [&#39;EP_NOHSDP&#39;,&#39;EP_LIMENG&#39;,&#39;EP_NOVEH&#39;]
yend_names = [&#39;HIS_ct&#39;]
q_names = [&#39;COORD_X&#39;,&#39;COORD_Y&#39;]
ds_name = &#39;Chi-SDOH&#39;
w_name = &#39;Chi-SDOH_q&#39;
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">read_file</span></code> and <code class="docutils literal notranslate"><span class="pre">open</span></code> functions are used to access the sample data set and contiguity weights. The weights are row-standardized and the data frames for the dependent and explanatory variables are constructed. As before, this functionality is agnostic to the actual data sets and variables used, since it relies on the specification given in the initial block above.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>dfs = gpd.read_file(infileshp)
wq =  open(infileq).read()
wq.transform = &#39;r&#39;    # row-transform the weights
y = dfs[y_name]
x = dfs[x_names]
yend = dfs[yend_names]
xe = dfs[xe_names]
q = dfs[q_names]
</pre></div>
</div>
</div>
<section id="The-SAR-SAR-Model">
<h3>The SAR-SAR Model<a class="headerlink" href="#The-SAR-SAR-Model" title="Link to this heading">¶</a></h3>
</section>
</section>
<section id="Exogenous-variables-only">
<h2>Exogenous variables only<a class="headerlink" href="#Exogenous-variables-only" title="Link to this heading">¶</a></h2>
<p>GMM estimation of the SAR-SAR model is implemented in <code class="docutils literal notranslate"><span class="pre">spreg.GMM_Error</span></code>. This requires the standard regression arguments (i.e., at a minimum, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">w</span></code>, as well as <code class="docutils literal notranslate"><span class="pre">yend</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code> for the endogenous case), as well as <code class="docutils literal notranslate"><span class="pre">add_wy</span> <span class="pre">=</span> <span class="pre">True</span></code>. The same three methods are implemented as for generic <code class="docutils literal notranslate"><span class="pre">GMM_Error</span></code>, but here only the default <code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">=</span> <span class="pre">&quot;het&quot;</span></code> will be considered. Also, none of the special options are included (see the GMM Error notebook for details).</p>
<p>GMM-heteroskedastic is the default, so the <code class="docutils literal notranslate"><span class="pre">estimator</span></code> argument does not need to be specified. The first illustration is for all default settings with only exogenous regressors. As usual, there is the option to use higher order lags for the instruments, but this is not pursued here.</p>
<p>Also, note that in constrast to the standard lag (and spatial Durbin) specifications, there is no <code class="docutils literal notranslate"><span class="pre">spat_impacts</span></code> option.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>sarsar1 = GMM_Error(y,x,w=wq,
                 add_wy=True,
                     name_w=w_name,name_ds=ds_name)
print(sarsar1.summary)
</pre></div>
</div>
</div>
<p>In this example, there was no evidence to include a spatial error term suggested by the AK test in the spatial lag model (see the notebook on IV estimation of the spatial lag model). As a result, it is not a surprise to find the coefficient <span class="math notranslate nohighlight">\(\lambda\)</span> not to be significant. Typical in the SAR-SAR model, the signs of <span class="math notranslate nohighlight">\(\rho\)</span> and <span class="math notranslate nohighlight">\(\lambda\)</span> tend to be opposite, which is difficult to interpret and may point to an identification problem.</p>
</section>
<section id="Exogenous-and-endogenous-variables">
<h2>Exogenous and endogenous variables<a class="headerlink" href="#Exogenous-and-endogenous-variables" title="Link to this heading">¶</a></h2>
<p>An extension to include additional endogenous variables is carried out in the standard way. The endogenous variables and associated instruments are listed below the table with estimates. As usual, there is an option to include the spatial lags of the instruments (<code class="docutils literal notranslate"><span class="pre">True</span></code> by default).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>sarsar2 = GMM_Error(y,xe,w=wq,yend=yend,q=q,
                     add_wy = True,
                     name_w=w_name,name_ds=ds_name)
print(sarsar2.summary)
</pre></div>
</div>
</div>
<p>The consideration of endogeneity makes <strong>HIS_ct</strong> insignificant (as well as <strong>EP_NOHSDP</strong>). The <span class="math notranslate nohighlight">\(\lambda\)</span> coefficient remains non-significant, but its sign changes.</p>
<section id="The-GNS-Model">
<h3>The GNS Model<a class="headerlink" href="#The-GNS-Model" title="Link to this heading">¶</a></h3>
<p>The GNS model is treated as an SLX-Error model with an additional spatially lagged dependent variable as a regressor. This is accomplished by setting both <code class="docutils literal notranslate"><span class="pre">slx_lags</span> <span class="pre">=</span> <span class="pre">1</span></code> (or higher) and <code class="docutils literal notranslate"><span class="pre">add_wy</span> <span class="pre">=</span> <span class="pre">True</span></code> in the <code class="docutils literal notranslate"><span class="pre">GMM_Error</span></code> call. As in the SAR-SAR case, there is no <code class="docutils literal notranslate"><span class="pre">spat_impacts</span></code> option.</p>
</section>
</section>
<section id="id2">
<h2>Exogenous variables only<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>gns1 = GMM_Error(y,x,w=wq,
                     slx_lags = 1, add_wy = True,
                     name_w=w_name,name_ds=ds_name)
print(gns1.summary)
</pre></div>
</div>
</div>
<p>The results are only provided as an illustration of the functionality. Again, the typical pattern emerges of opposite signs for <span class="math notranslate nohighlight">\(\rho\)</span> and <span class="math notranslate nohighlight">\(\lambda\)</span>, but now only <span class="math notranslate nohighlight">\(\lambda\)</span> is significant. None of the SLX terms is significant at p=0.01, and of the original regressors, only <strong>EP_LIMENG</strong> remains significant.</p>
</section>
<section id="id3">
<h2>Exogenous and endogenous variables<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h2>
<p>Endogenous variables are included by specifying <code class="docutils literal notranslate"><span class="pre">yend</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code> (the <code class="docutils literal notranslate"><span class="pre">x</span></code> argument is set to <code class="docutils literal notranslate"><span class="pre">xe</span></code>, for exogenous variables only).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>gns2 = GMM_Error(y,xe,w=wq,yend=yend,q=q,
                     add_wy = True,slx_lags = 1,
                     name_w=w_name,name_ds=ds_name)
print(gns2.summary)
</pre></div>
</div>
</div>
<p>In this example, the estimate of <span class="math notranslate nohighlight">\(\rho\)</span> is 0.9, which is highly suspicious. The estimate for <span class="math notranslate nohighlight">\(\lambda\)</span> is now marginally significant and positive. Of the other variables in the model, only <strong>EP_LIMENG</strong> remains as significant.</p>
<p>Again, this highlights the caution that is needed when implementing this model. In general, it should be avoided and the model under consideration should be respecified in a different way.</p>
<section id="Practice">
<h3>Practice<a class="headerlink" href="#Practice" title="Link to this heading">¶</a></h3>
<p>Since these models should be avoided, there is not much point in practicing them, other than to gain insight into the often conflicting (and confusing) indications provided by the parameter estimates. It is not because a model is not identified that no estimates can be obtained. However, those results are not necessarily (and usually not) meaningful.</p>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/notebooks/17_GMM_higher_order.ipynb.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2018-, pysal developers.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 9.1.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>